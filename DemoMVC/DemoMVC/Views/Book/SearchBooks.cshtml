@model IEnumerable<DemoMVC.Models.Book>
@using DemoMVC.Models;

@{
    ViewBag.Title = "SearchBooks";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>SearchBooks</h2>

<div>
    <h4>Book</h4>
    <hr />
    <dl class="dl-horizontal">
        <div>
            <table border="1">
                <tr>
                    <td colspan="5" align="center" style="font-weight:800">Book Name</td>
                </tr>
                @foreach (Book book in Model)
                {
                    <tr>
                        <td width="300" class="bookClazz" bookId="@book.ID">@book.BookName </td>
                        <td width="300">@book.Author </td>
                        <td width="300">@book.isPrezent </td>
                        <td width="300">@book.Price </td>  
                        <td width="300">@Html.ActionLink("Edit", "EditBook", "Book", new { bookId = book.ID }, null)</td>
                        <td width="300"><a href="#" class="delete-book" bookId="@book.ID">Delete</a></td>
                    </tr>
                }
            </table>
</dl>
</div>
<p>
  @Html.ActionLink("Back to List", "List")
</p>
<script>
    function identitySearchVal() {
        var path = "/Book/SearchBooks?val=";
        $("#refId").attr("href", path + $("#inputId").val())
    }
  /*  $(".bookClazz").click(function(e){
        var bookId=$(this).attr('bookId');
        alert ('Book ID is: ' + bookId)
    })*/
    $(".delete-book").click(function (e) {
        var Id = $(this).attr('bookId');
        $.ajax({
            type: "POST",
            url: "/Book/DeleteBook",
            data: { bookId:Id },
            async: true,
            success: function (rezult) {
                switch (rezult) {
                    case '1': {
                        alert("Book has been succesfully deleted!");
                        location.reload();
                    } break;
                    case '2': alert("Book has been not deleted!!"); break;
                    default: alert("bookId is incorrect"); break;

                }

            }
        })
    })
</script>